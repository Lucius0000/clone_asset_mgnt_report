#  资产管理双周报_标杆指数、股票&基金(us, cn, hk)

## 核心功能

- **多市场支持**: 美股、中港股、混合模式
- **智能日期管理**: 自动计算交易周期，处理不同市场时区差异
- **全面指标计算**: 一周变动、YTD、MoM、YoY、市值、夏普比率、年化波动率
- **分类报告**: 按行业/资产类别自动分组，生成Excel报告

## 安装依赖

```bash
pip install -r requirements.txt
```

主要依赖：
- `yfinance`: 股票数据获取
- `pandas`, `numpy`: 数据处理
- `openpyxl`: Excel文件生成
- `python-dateutil`: 日期计算

## 快速开始

```bash
python market_report_china_hk.py
```

1. **选择市场模式**
   - `1`: 美股模式 (SPY, QQQ, 科技股等)
   - `2`: 中港股模式 (A股ETF, 港股个股等)  
   - `3`: 混合模式 (全市场覆盖)

2. **选择时间范围**
   - 智能默认: 自动计算上周五→本周六
   - 手动输入: 自定义日期范围

3. **自动生成报告**
   - Excel文件包含汇总表和分类子表
   - 颜色编码显示涨跌幅
   - 支持 `n/a` 标记缺失数据

## 输出文件

生成的Excel报告包含：

- **汇总工作表**: 全部标的概览
- **分类工作表**: 按投资类别分组
  - 美股：大盘/行业ETF、个股(七巨头/半导体/SaaS等)
  - 中港股：A股ETF/个股、港股各行业
- **指标列**: 一周变动、YTD、MoM、YoY、收盘价、市值、夏普比率、年化波动率

## 配置说明

### 添加新标的

在 `market_symbols` 字典中添加：
```python
china_hk_market_symbols = {
    '标的名称': 'SYMBOL.EXCHANGE',  # 如: '腾讯控股': '0700.HK'
    # ...
}
```

### 自定义分类

在 `categories` 字典中配置：
```python
china_hk_categories = {
    '港股-股票-个股-科技': ['腾讯控股', '阿里巴巴'],
    # ...
}
```

## 注意事项

- 默认计算基于252个交易日年化、一年期Sharpe Ratio
- 智能默认模式，只能在当周收盘后能跑通。平时推荐使用 "混合模式" + “手动输入/ 自定义日期范围”生成报告。
- "手动输入/ 自定义日期范围"模式中，结束日期需要为当周周六。开始日期为上周最后一个交易日。